import e,{div as t}from"/Utils/elements.js";import{useEffect as n,useState as r}from"/cdn/react";import s from"/Utils/load-css.js";const o=s("/Components/card-template/image-render.css");let a={};function i(e){if(a[e])return a[e];const t=new Worker("/Components/card-template/image-render-worker.js");return a[e]=function(e){return new Promise((t=>{const n=new Image;n.addEventListener("load",(()=>{t({width:n.width,height:n.height,image:n})})),n.src=e}))}(e).then((n=>new Promise(((r,s)=>{const o=e.indexOf(","),a=e.substring(o+1),i=e.substring(0,o);t.onmessage=e=>{t.terminate(),r({...n,blob:e.data})},t.onerror=e=>{t.terminate(),s(e)};const c=((e,t="",n=512)=>{const r=atob(e),s=[];for(let e=0;e<r.length;e+=n){const t=r.slice(e,e+n),o=new Array(t.length);for(let e=0;e<t.length;e++)o[e]=t.charCodeAt(e);const a=new Uint8Array(o);s.push(a)}return new Blob(s,{type:t})})(a,i.replace("data:","").replace(";base64",""));t.postMessage({...n,image:c})})))).then((async e=>{var t;return e.b64=await(t=e.blob,new Promise(((e,n)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.readAsDataURL(t)}))),e}))}export default e((function(e){const{url:s}=e,[o,a]=r({});return n((()=>{s&&i(s).then(a)}),[s]),t({className:"processed-art "+(s&&!o.b64?"loading":""),style:{"--width":o.width||0,"--height":o.height||0,backgroundImage:o.b64?`url(${o.b64})`:""}},s&&!o.b64?t({className:"icon"},t({className:"loading"})):void 0)}),o);