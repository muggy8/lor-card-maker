import e,{div as t}from"/Utils/elements.js";import{useEffect as a,useState as n}from"/cdn/react";import r from"/Utils/load-css.js";const o=r("/Components/card-template/image-render.css");let s={};const i=fetch("/Components/card-template/image-render-worker.js").then((e=>e.text()));function c(e){if(s[e])return s[e];let t;return s[e]=i.then((e=>{const a=`data:text/javascript;base64,${btoa(e)}`;t=new Worker(a)})).then((()=>function(e){return new Promise((t=>{const a=new Image;a.addEventListener("load",(()=>{t({width:a.width,height:a.height,image:a})})),a.src=e}))}(e))).then((async a=>{const n=await fetch(e).then((e=>e.blob())),r=await createImageBitmap(n);return new Promise(((o,s)=>{t.onmessage=e=>{t.terminate(),o({...a,blob:e.data})},t.onerror=e=>{t.terminate(),o({...a,blob:n})},t.postMessage({...a,image:r,b64:e})}))})).then((async e=>{var t;return e.b64=await(t=e.blob,new Promise(((e,a)=>{const n=new FileReader;n.onloadend=()=>e(n.result),n.readAsDataURL(t)}))),e}))}export default e((function(e){const{url:r}=e,[o,s]=n({});return a((()=>{r&&c(r).then(s)}),[r]),t({className:"processed-art "+(r&&!o.b64?"loading":""),style:{"--width":o.width||0,"--height":o.height||0,backgroundImage:o.b64?`url(${o.b64})`:""}},r&&!o.b64?t({className:"icon"},t({className:"loading"})):void 0)}),o);