import e,{div as t}from"/Utils/elements.js";import{useEffect as n,useState as r}from"/cdn/react";import a from"/Utils/load-css.js";const s=a("/Components/card-template/image-render.css");let o={};const i=fetch("/Components/card-template/image-render-worker.js").then((e=>e.text()));function c(e){if(o[e])return o[e];let t;return o[e]=i.then((e=>{const n=`data:text/javascript;base64,${btoa(e)}`;t=new Worker(n)})).then((()=>function(e){return new Promise((t=>{const n=new Image;n.addEventListener("load",(()=>{t({width:n.width,height:n.height,image:n})})),n.src=e}))}(e))).then((n=>new Promise(((r,a)=>{const s=e.indexOf(","),o=e.substring(s+1),i=e.substring(0,s);t.onmessage=e=>{t.terminate(),r({...n,blob:e.data})},t.onerror=e=>{t.terminate(),a(e)};const c=((e,t="",n=512)=>{const r=atob(e),a=[];for(let e=0;e<r.length;e+=n){const t=r.slice(e,e+n),s=new Array(t.length);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);const o=new Uint8Array(s);a.push(o)}return new Blob(a,{type:t})})(o,i.replace("data:","").replace(";base64",""));t.postMessage({...n,image:c})})))).then((async e=>{var t;return e.b64=await(t=e.blob,new Promise(((e,n)=>{const r=new FileReader;r.onloadend=()=>e(r.result),r.readAsDataURL(t)}))),e}))}export default e((function(e){const{url:a}=e,[s,o]=r({});return n((()=>{a&&c(a).then(o)}),[a]),t({className:"processed-art "+(a&&!s.b64?"loading":""),style:{"--width":s.width||0,"--height":s.height||0,backgroundImage:s.b64?`url(${s.b64})`:""}},a&&!s.b64?t({className:"icon"},t({className:"loading"})):void 0)}),s);