import e,{label as t,div as s,strong as a,button as o,input as r}from"/Utils/elements.js";import l from"/Utils/use-lang.js";import{useCallback as c,useState as n,useContext as i,useEffect as m,useRef as u}from"/cdn/react";import d from"/Components/card-template/svg-wrap.js";import f,{keywords as g}from"/Components/card-template/keyword-renderer.js";import{Globals as k}from"/Views/index.js";import p from"/Utils/use-toggle.js";export const KeywordImageCheck=e((function(e){const t=e.isChecked,[a,o]=n({width:120,height:104});return s({className:"gutter-trbl-.25 clickable flex column vhcenter "+(t?"":"ghost"),onClick:e.onClick},d(a,f({name:e.keywordName,size:e.size||"small",icons:e.icons,onDimension:o})))}));export default e((function(e){const d=l(),f=i(k),w=u();w.current=f;const{customKeywords:x}=f,N=c((t=>{if(e.value.indexOf(t)>-1){const s=e.value.filter((e=>e!==t));return e.updateValue(s)}const s=[...e.value,t];e.updateValue(s)}),[e.value,e.updateValue]),h=c((t=>{if(e.value.findIndex((e=>e.id===t.id))>-1){const s=e.value.filter((e=>e.id!==t.id));return e.updateValue(s)}const s=[...e.value,t];e.updateValue(s)}),[e.value,e.updateValue]),[y,C]=n(""),b=c((e=>{C((e.target.value||"").toLowerCase())}),[C]),[v,j,V]=p(!1),[I,K]=n(0);return m((()=>{if(v)K(document.documentElement.scrollTop);else{const e=!0===w.current.state.settings.lowSpecsMode;window.scrollTo({top:I,left:0,behavior:e?"instant":"smooth"}),C("")}}),[v,I,K,C]),s(s({onClick:j,className:"flex clickable"},s({className:"grow"},t(a(d("keyword"))))),s({className:"gutter-b"},(e.value||[]).map((e=>{if("string"==typeof e){const t=e;return s({className:"flex no-wrap gutter-t-.5",key:t},s({className:"grow flex start"},KeywordImageCheck({keywordName:t,isChecked:!0,size:"large"})),o({className:"gutter-trbl-.5",onClick:()=>N(t)},s({className:"icon multiply"})))}if("object"==typeof e){const t=e;return s({className:"flex no-wrap gutter-t-.5",key:t.id},s({className:"grow flex start"},KeywordImageCheck({keywordName:t.name,icons:t.icons,isChecked:!0,size:"large"})),o({className:"gutter-trbl-.5",onClick:()=>h(t)},s({className:"icon multiply"})))}}))),s({className:"flex"},o({className:"grow gutter-trbl-.5",onClick:j},d(v?"hide_keyword_list":"add_keyword"))),s({className:"flex hcenter gutter-b-2 accordian "+(v?"expanded":"")},s({className:"flex box-12 gutter-tb-.5"},r({value:y,onChange:b,type:"search",placeholder:d("search"),className:"grow gutter-trbl-.5"}),s({className:"gutter-r-.5"}),o({className:"gutter-tb-0.5 gutter-rl flex vhcenter",onClick:()=>C("")},s({className:"icon multiply"}))),Object.keys(g).map((t=>{if(y&&!t.toLowerCase().includes(y))return;const a=e.value.some((e=>e===t));return s({className:"box-xs-4 box-m-3 box-l-2 flex vhcenter",key:t},KeywordImageCheck({isChecked:a,onClick:()=>{N(t)},keywordName:t}))})).filter((e=>!!e)),x.map((t=>{if(y&&!t.name.toLowerCase().includes(y))return;const a=e.value.some((e=>e.id===t.id));return s({className:"box-xs-4 box-m-3 box-l-2 flex vhcenter",key:t.id},KeywordImageCheck({keywordName:t.name,icons:t.icons,isChecked:a,onClick:()=>h(t)}))})).filter((e=>!!e)),s({className:"flex box-12 gutter-t-.5"},o({className:"grow gutter-trbl-.5",onClick:()=>V(!1)},d("hide_keyword_list")))))}));