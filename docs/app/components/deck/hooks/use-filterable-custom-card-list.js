import{useCallback as e,useEffect as t}from"/cdn/react";import{getCardList as r}from"/Utils/service.js";import o from"/Utils/use-filter.js";import n from"/Utils/use-asset-cache.js";import i from"/Components/deck/hooks/get-filter-options-form-card-list.js";export default function l(l){const s=n((e=>{r({exclude:["deck"]}).then((t=>{e(t),t.forEach((e=>{e&&e.id&&(l.current[e.id]=e)}))}))}),[]),[c,f,a,u]=o({name:{filter:(e,t)=>!e||t.toLowerCase().includes(e.toLowerCase())},effect:{filter:(e,t)=>!e||t.toLowerCase().includes(e.toLowerCase())},lvup:{filter:(e,t)=>!e||t.toLowerCase().includes(e.toLowerCase())},clan:{filter:(e,t)=>!e||Array.prototype.some.call(t,(t=>t.toLowerCase().includes(e.toLowerCase())))},keywords:{filter:(e,t)=>!e||!e.length||t.some((t=>e.includes(t)||e.some((e=>"string"!=typeof e&&"string"!=typeof t&&e.id===t.id))))},rarity:{filter:(e,t)=>!e||!e.length||e.includes(t)},type:{filter:(e,t)=>!e||!e.length||e.includes(t)},faction:{filter:(e,t)=>!e||!e.length||e.some((e=>t.includes(e)))},speed:{filter:(e,t)=>!e||!e.length||e.includes(t)},mana:{filter:(e,t)=>{if(!e||!e.length)return!0;const[r,o]=e;return t<=o&&t>=r}},power:{filter:(e,t,r)=>{if(!e||!e.length)return!0;if("unit"!==(r.type||"").toLowerCase())return!1;const[o,n]=e;return t<=n&&t>=o}},health:{filter:(e,t,r)=>{if(!e||!e.length)return!0;if("unit"!==(r.type||"").toLowerCase())return!1;const[o,n]=e;return t<=n&&t>=o}}});t((()=>{if(!s||!s.length)return f([]);f(s)}),[s]);const p=e(((e,t)=>{const r={};r[e]=t,u(r)}),[u]),d=n((e=>{if(!(s&&s.length&&c&&c.length))return;const t=i(s);t.health&&(t.health=t.health.filter((e=>null!=e))),t.power&&(t.power=t.power.filter((e=>null!=e))),t.mana&&(t.mana=t.mana.filter((e=>null!=e)));const r=t.type;r&&(t.type=t.type.filter((e=>!e.toLowerCase().includes("champion"))),r.length!==t.type.length&&t.type.push("champion"));const o=i(c),n=[];o.keywords&&(o.keywords=o.keywords.filter((e=>{const t=e.id||e;return!n.includes(t)&&(n.push(t),!0)})));e({...t,keywords:o.keywords})}),[s,c],{});return{cardList:s,filteredCardList:c,currentFilters:a,patchFilter:p,patchFilters:u,filterOptions:d}}